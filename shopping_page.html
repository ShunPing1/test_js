<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shopping_page</title>
    <link rel="stylesheet" href="CSS/old.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

</head>

<body>
    <div class="path_block">
        <div class="public_container path">
            <div class="links">
                <div class="link"><a href="#">首頁</a></div>
                <div class="link"><a href="#">購物商城</a></div>
                <div class="link link_active"><a href="#">上衣</a></div>
            </div>
        </div>
    </div>
    <div class="public_container page_products_all">
        <div class="page_products_left">
            <div class="select select_PC">

                <div class="type_block type_PC_block">
                    <div class="option major_option shorts_type">上衣 <i class="fa-solid fa-angle-right"></i></div>
                    <div class="public_selects_block">
                        <a href="#">
                            <p class="option option_item option_active">護理衣</p>
                        </a>
                        <a href="#">
                            <p class="option option_item">護理褲</p>
                        </a>
                    </div>
                </div>
                <div class="type_block  type_PC_block">
                    <div class="option major_option pants_type">褲子 <i class="fa-solid fa-angle-right"></i></div>
                    <div class="public_selects_block">
                        <a href="#">
                            <p class="option option_item option_active">褲子1</p>
                        </a>
                        <a href="#">
                            <p class="option option_item">褲子2</p>
                        </a>
                    </div>
                </div>
                <div class="type_block  type_PC_block">
                    <div class="option major_option tools_type">用具 <i class="fa-solid fa-angle-right"></i></div>
                    <div class="public_selects_block">
                        <a href="#">
                            <p class="option option_item option_active">用具1</p>
                        </a>
                        <a href="#">
                            <p class="option option_item">用具2</p>
                        </a>
                    </div>
                </div>

            </div>
            <!-- 手機板選單 -->
            <div class="select select_phone">
                <p class="option option_all">
                    總選單<i class="fa-solid fa-angle-right"></i>
                </p>
                <!-- 選單內容 -->
                <div class="phone_option_block">
                    <div class="type_block">
                        <div class="option major_option shorts_type">上衣 <i class="fa-solid fa-angle-right"></i></div>
                        <div class="public_selects_block">
                            <a href="#">
                                <p class="option option_item option_active">護理衣</p>
                            </a>
                            <a href="#">
                                <p class="option option_item">護理褲</p>
                            </a>
                        </div>
                    </div>
                    <div class="type_block">
                        <div class="option major_option pants_type">褲子 <i class="fa-solid fa-angle-right"></i></div>
                        <div class="public_selects_block">
                            <a href="#">
                                <p class="option option_item option_active">褲子1</p>
                            </a>
                            <a href="#">
                                <p class="option option_item">褲子2</p>
                            </a>
                        </div>
                    </div>
                    <div class="type_block">
                        <div class="option major_option tools_type">用具 <i class="fa-solid fa-angle-right"></i></div>
                        <div class="public_selects_block">
                            <a href="#">
                                <p class="option option_item option_active">用具1</p>
                            </a>
                            <a href="#">
                                <p class="option option_item">用具2</p>
                            </a>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="page_products_right">
            <div class="page_products_content_block">
                <div class="page_products_content page_products_img">
                    <div class="coat_img_block">
                        <img src="img/_CR836_color_3.jpeg" alt="" class="main_coat_img">
                        <div class="coat_img"></div>
                    </div>
                    <!-- swiper -->
                    <div class="coat_swiper_block">
                        <div class="hide_scroll">
                            <div class="coat_swiper_scroll">
                                <div class="coat_swiper">
                                    <div class="coat_swiper_item">
                                        <img src="img/_CR836_color_3.jpeg" alt="" class="coat_swiper_img">
                                    </div>
                                    <div class="coat_swiper_item">
                                        <img src="img/_CR836_color_4.jpeg" alt="" class="coat_swiper_img">
                                    </div class="coat_swiper_item">
                                    <div class="coat_swiper_item">
                                        <img src="img/_CR836_color_2.jpeg" alt="" class="coat_swiper_img">
                                    </div>
                                    <div class="coat_swiper_item">
                                        <img src="img/_CR836_color_3.jpeg" alt="" class="coat_swiper_img">
                                    </div>
                                    <div class="coat_swiper_item">
                                        <img src="img/_CR836_color_4.jpeg" alt="" class="coat_swiper_img">
                                    </div class="coat_swiper_item">
                                    <div class="coat_swiper_item">
                                        <img src="img/_CR836_color_2.jpeg" alt="" class="coat_swiper_img">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="coat_switch coat_switch_left"><i class="fa-solid fa-caret-left"></i></div>
                        <div class="coat_switch coat_switch_right"><i class="fa-solid fa-caret-right"></i></div>
                    </div>
                </div>
                <div class="page_products_content page_price_information">
                    <div class="price_title_block">
                        <div class="price_name">舒適護理衣(綠)</div>
                        <div class="favorite">
                            <img src="./img/heart-1.png" alt="">
                        </div>
                    </div>
                    <div class="page_products_padding_right">
                        <div class="product_narrate_block">
                            <div class="narrate_title">商品敘述：</div>
                            <div class="narrate_text">
                                Lorem ipsum dolor sit amet consectetur, adipisicing elit. Asperiores at quis est
                                ducimus nulla, accusantium commodi? Omnis, dolore ut
                            </div>
                        </div>
                        <div class="product_format_block">
                            <div class="format_title">商品規格：</div>
                            <div class="format_block">
                                <div class="format_control">
                                    <div class="format_tags">
                                        <div class="format_item">規格A</div>
                                        <div class="format_item">規格B</div>
                                        <div class="format_item">規格C</div>
                                        <div class="format_item">規格D</div>
                                    </div>
                                    <hr>
                                    <div class="format_options">
                                        <div class="format_item format_subItem">規格A-1</div>
                                        <div class="format_item format_subItem">規格A-3</div>
                                        <div class="format_item format_subItem">規格A-2</div>
                                        <div class="format_item format_subItem">規格A-4</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="price_calc_block">
                            <div class="calc_content amount">
                                <button type="button" class="calc_btn minus_btn"><i
                                        class="fa-solid fa-minus"></i></button>
                                <input type="text" name="" id="amount_input" class="amount_num" value="0">
                                <button type="button" class="calc_btn plus_btn"><i
                                        class="fa-solid fa-plus"></i></button>
                            </div>
                            <div class="calc_content sale">
                                <p class="calc_item ori_price">售價$300</p>
                                <p class="calc_item discount">優惠價$100</p>
                            </div>
                        </div>
                        <div class="pay_block">
                            <a href="#">
                                <div class="pay_btn to_pay">
                                    <img src="./img/去購物-icon.png" alt="">
                                    &ensp;去結帳
                                </div>
                            </a>
                            <a href="#">
                                <div class="pay_btn add_cart">
                                    <img src="./img/加入購物車-icon.png" alt="">
                                    &ensp;加入購物車
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="jquery3.js"></script>
    <script>
        // 全域變數
        let formatArr = [
            {
                formatName: '規格A',
                formatItems: ['規格A-1', '規格A-3', '規格A-2', '規格A-4'],
            },
            {
                formatName: '規格B',
                formatItems: ['規格B-1', '規格B-3', '規格B-2', '規格B-4'],
            },
            {
                formatName: '規格C',
                formatItems: ['規格C-1', '規格C-3', '規格C-2', '規格C-4'],
            },
            {
                formatName: '規格D',
                formatItems: ['規格D-1', '規格D-3', '規格D-2', '規格D-4'],
            },
        ]

        $(document).ready(function () {

            // 標籤生成
            let newFormatArr = [];
            $.each(formatArr, function (index, value) {
                newFormatArr.push(`<div class="format_item">${formatArr[index].formatName}</div>`);
            })
            let formatHTML = newFormatArr.join('');
            $('.format_tags').html(formatHTML);

            // 標籤對應內容
            $('.format_item').click(function () {
                let formatClicked = $(this).attr("itemID");
                console.log(formatClicked);
                let formatTarget = formatArr.find(function (item) {
                    return formatClicked == item.formatName;
                });

                console.log(formatTarget);


                if (formatTarget) {
                    let subItemHTML = formatTarget.formatItems.map(function (item) {
                        return `<div class="format_item format_subItem">${item}</div>`;
                    }).join('');
                    $(this).parent('.format_tags').siblings('.format_options').html(subItemHTML);
                };


                $('.format_subItem').click(function () {

                    $('.format_options .format_item').removeClass('format_active');
                    $(this).addClass('format_active');
                });
            })

            $('.format_tags .format_item').click(function () {
                console.log(3333);
                $('.format_tags .format_item').removeClass('format_active');
                $(this).addClass('format_active');
            })

            // 手風琴選單
            $('.public_selects_block').hide();
            $('.type_block .major_option').click(function () {
                $(this).next('.public_selects_block').slideDown('slow');
                $('.type_block .major_option').not($(this)).next('.public_selects_block').slideUp('slow');;
            })

            $('.major_option').click(function () {
                $('.major_option').find('i').removeClass('fa-chevron-down').addClass('fa-angle-right')
                $(this).find('i').removeClass('fa-angle-right').addClass('fa-chevron-down')
            });

            // 選單選取
            $('.option_item').click(function () {
                $('.option_item').removeClass('option_active');
                $(this).addClass('option_active');
            });

            // 手機板總選單
            let allOptionChecked = false;
            $('.phone_option_block').hide();
            $('.option_all').click(function () {
                allOptionChecked = !allOptionChecked;
                console.log(allOptionChecked);
                if (allOptionChecked) {
                    $(this).find('i').removeClass('fa-angle-right').addClass('fa-chevron-down')
                    $('.phone_option_block').slideDown('slow');
                } else {
                    $(this).find('i').removeClass('fa-chevron-down').addClass('fa-angle-right')
                    $('.phone_option_block').slideUp('slow');

                }
            });

            // 愛心切換
            $('.favorite').click(function () {
                let imgSrc = $(this).find('img').attr('src');
                if (imgSrc == 'img/heart-2.png') {
                    $(this).find('img').attr('src', 'img/heart-1.png');
                } else {
                    $(this).find('img').attr('src', 'img/heart-2.png');
                }
            })

            // 商品增減
            $('.calc_btn').click(function () {
                let input = $(this).siblings('#amount_input');
                let num = parseInt(input.val());
                if (num < 0) return;
                
                if ($(this).hasClass('plus_btn')) {
                    num++;
                    input.val(num);
                } else {
                    num--;
                    if (num < 0) return;
                    input.val(num);
                };
            });

            // input 防呆
            $('#amount_input').change(function () {
                let inputVal = $(this).val();
                // console.log(inputVal == null);
                if (isNaN(inputVal) || inputVal.length < 1 || inputVal < 0) {
                    $(this).val(0);
                    console.log(false);
                } else {
                    console.log(true);
                }


            });

            // 點擊小圖換大圖圖片
            $('.coat_swiper_img').click(function () {
                console.log(111);
                $('.main_coat_img').attr('src', $(this).attr('src'))

            });

            // 動態調整.hide_scroll高度
            $('.hide_scroll').height($('.coat_swiper_item').height());
            $(window).resize(function(){
                $('.hide_scroll').height($('.coat_swiper_item').height());
            });

            // 輪播
            let scrollBar = 0;
            $('.coat_switch').click(function () {
                let swiperWidth = $('.coat_swiper_item').width() + 8;
                if ($(this).hasClass('coat_switch_left')) {
                    scrollBar++;
                    $('.coat_swiper_scroll').scrollLeft(scrollBar * swiperWidth);
                    if (scrollBar > 3) scrollBar = 3;
                    console.log('prev:', scrollBar);
                } else {
                    scrollBar--;
                    $('.coat_swiper_scroll').scrollLeft(scrollBar * swiperWidth);
                    if (scrollBar < 0) scrollBar = 0;
                    console.log('next:' + scrollBar);
                    
                }

            });

        });

    </script>
</body>

</html>